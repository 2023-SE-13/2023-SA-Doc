"use strict";(self["webpackChunkscholarhub"]=self["webpackChunkscholarhub"]||[]).push([[641],{1641:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"navi"},[t("NaviBar")],1),t("div",{staticClass:"phpContainer"},[t("div",{staticClass:"Info"},[t("el-upload",{staticClass:"avatar_upload",attrs:{action:"#","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"http-request":e.uploadPic}},[t("img",{staticClass:"image-container",attrs:{id:"Photo",src:this.imageUrl,alt:"头像",width:"170px",height:"170px"}}),t("div",{staticClass:"image-black-cover"},[t("i",{staticClass:"el-icon-plus"})])]),t("div",{staticClass:"PersonalInfo"},[t("p",{staticStyle:{"font-size":"20px",color:"black","font-weight":"bold"}},[e._v(" 用户名："+e._s(e.username)+" "),t("span",[t("i",{directives:[{name:"show",rawName:"v-show",value:e.isSelf,expression:"isSelf"}],staticClass:"el-icon-edit",on:{click:e.modify}},[e._v("详细资料")]),t("el-dialog",{staticClass:"info_dialog",attrs:{visible:e.infoDialog,"append-to-body":!0},on:{"update:visible":function(t){e.infoDialog=t}}},[t("el-descriptions",{attrs:{column:1,"label-style":{"font-size":"20px"}}},[e.infoDialogTitle?t("span",{staticStyle:{"font-size":"25px"},attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"el-icon-postcard"}),e._v(" 资料 ")]):t("span",{staticStyle:{"font-size":"25px"},attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 编辑资料 ")]),e.infoDialogTitle?t("template",{slot:"extra"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.modify_info}},[e._v("编辑")])],1):t("template",{slot:"extra"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.modify_confirm()}}},[e._v("确认")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.modify_cancel}},[e._v("取消")]),t("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.modify_clear}},[e._v("清空")])],1),t("el-descriptions-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{placeholder:"请输用户名",disabled:e.inputDisabled},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),t("el-descriptions-item",{attrs:{label:"真实姓名"}},[t("el-input",{attrs:{placeholder:"请输入真实姓名",disabled:e.inputDisabled},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),t("el-descriptions-item",{attrs:{label:"机构"}},[t("el-input",{attrs:{placeholder:"请输入机构",disabled:e.inputDisabled},model:{value:e.institution,callback:function(t){e.institution=t},expression:"institution"}})],1),t("el-descriptions-item",{attrs:{label:"邮箱"}},[t("el-input",{attrs:{placeholder:"请输入邮箱",disabled:e.inputDisabled},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],2)],1),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isSelf&&!e.isInterested,expression:"!isSelf && !isInterested"}],staticClass:"el-button-interest",on:{click:e.interest}},[t("i",{staticClass:"el-icon-plus"},[e._v("关注")])]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isSelf&&e.isInterested,expression:"!isSelf && isInterested"}],staticClass:"el-button-interested",on:{click:e.cancel_interest},nativeOn:{mouseover:function(t){return e.cancel_display.apply(null,arguments)},mouseleave:function(t){return e.cancel_hide.apply(null,arguments)}}},[e.isCancel?e._e():t("i",{staticClass:"el-icon-finished"},[e._v("已关注")]),e.isCancel?t("span",{staticClass:"el-icon-cancel"},[e._v("取消关注")]):e._e()])],1)]),t("p",{staticStyle:{"font-size":"16px",color:"#8590a6"}},[e._v("机构："+e._s(e.institution))])])],1),t("div",{staticClass:"MidNav"},[t("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":"1",mode:"horizontal","background-color":"#d7ecff","text-color":"#121212","active-text-color":"#2f3a91"},on:{select:e.handleSelect}},[t("el-menu-item",{attrs:{index:"1"}},[e._v("我的成果")]),t("el-menu-item",{attrs:{index:"2"}},[e._v("我的收藏")]),t("el-menu-item",{attrs:{index:"3"}},[e._v("浏览记录")]),t("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.isManager,expression:"isManager"}],attrs:{index:"4"}},[e._v("待办审核")])],1)],1),t("div",{staticClass:"Bottom"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.MidNavIdx,expression:"MidNavIdx === '1'"}],staticClass:"BottomContent1"},[t("el-menu",{staticClass:"el-menu1-demo",attrs:{"default-active":"1",mode:"horizontal"},on:{select:e.handleSelect1}},[t("el-menu-item",{attrs:{index:"1"}},[e._v("论文")]),t("el-menu-item",{attrs:{id:"item2",index:"2"}},[e._v("专利")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.Menu1Idx,expression:"Menu1Idx === '1'"}]},[t("el-empty",{staticClass:"empty",attrs:{image:"https://p3-bcy-sign.bcyimg.com/banciyuan/98758c3b7b734765a1d72d8adce82a65~tplv-banciyuan-w650.image?x-expires=1704558020&x-signature=pKwEtXe1SEZI7S9mE2pfRusp%2BRU%3D",description:"空空如也~"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.Menu1Idx,expression:"Menu1Idx === '2'"}]},[t("el-empty",{staticClass:"empty",attrs:{image:"https://p3-bcy-sign.bcyimg.com/banciyuan/98758c3b7b734765a1d72d8adce82a65~tplv-banciyuan-w650.image?x-expires=1704558020&x-signature=pKwEtXe1SEZI7S9mE2pfRusp%2BRU%3D",description:"空空如也~"}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.MidNavIdx,expression:"MidNavIdx === '2'"}],staticClass:"BottomContent2"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.collect_data.slice(e.begin3,e.end3)},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-table-column",{attrs:{label:"学术成果",prop:"paper_name"},on:{click:function(t){return e.gotoColArt(i.row.paper_id)}}})]}}])}),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:Math.ceil(e.collect_data.length/10)},on:{"prev-click":e.prev3,"next-click":e.next3,"current-change":e.pageChange3}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"3"===e.MidNavIdx,expression:"MidNavIdx === '3'"}],staticClass:"BottomContent3"},[t("el-button",{staticClass:"clear_button",on:{click:function(t){return e.clear_visit()}}},[e._v("清空")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.visit_data.slice(e.begin4,e.end4)}},[t("el-table-column",{attrs:{label:"浏览记录",prop:"work_name"}})],1),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:Math.ceil(e.visit_data.length/10)},on:{"prev-click":e.prev4,"next-click":e.next4,"current-change":e.pageChange4}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"4"===e.MidNavIdx,expression:"MidNavIdx === '4'"}],staticClass:"BottomContent4"},[t("div",{staticClass:"left4"},[t("el-menu",{staticClass:"el-menu4-demo",attrs:{mode:"vertical","default-active":"1"},on:{select:e.handleSelect4}},[t("el-menu-item",{attrs:{index:"1"}},[e._v("待认证学者")]),t("el-menu-item",{attrs:{index:"2"}},[e._v("待认领成果")]),t("el-menu-item",{attrs:{index:"3"}},[e._v("待处理申诉")])],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.Menu4Idx,expression:"Menu4Idx === '1'"}],staticClass:"right4_1"},[t("el-table",{attrs:{data:e.scholar_certification.slice(e.begin1,e.end1)}},[t("el-table-column",{attrs:{prop:"datetime",label:"申请时间",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("i",{staticClass:"el-icon-time"}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(i.row.datetime))])]}}])}),t("el-table-column",{attrs:{prop:"username",label:"申请用户",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"top",trigger:"hover"}},[t("div",{attrs:{slot:"reference"},slot:"reference"},[t("el-tag",{attrs:{size:"medium"}},[e._v(e._s(i.row.username))])],1)])]}}])}),t("el-table-column",{attrs:{prop:"detail",label:"详情",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{staticClass:"detail-button",on:{click:function(t){return e.visitAuth(i.row.author_id)}}},[e._v("点击查看")]),t("el-dialog",{attrs:{title:"认证学者申请",visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 用户名 ")]),e._v(" "+e._s(i.row.username)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 真实姓名 ")]),e._v(" "+e._s(null)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-location-outline"}),e._v(" 描述 ")]),e._v(" "+e._s(null)+" ")],2)],1)],1)]}}])}),t("el-table-column",{attrs:{prop:"operator",label:"处理操作"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{staticClass:"check",on:{click:function(t){return e.accept(i.$index)}}},[t("i",{staticClass:"el-icon-check"})]),t("el-button",{staticClass:"close",on:{click:function(t){return e.refuse(i.$index)}}},[t("i",{staticClass:"el-icon-close"})])]}}])})],1),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:Math.ceil(e.scholar_certification.length/10)},on:{"prev-click":e.prev,"next-click":e.next,"current-change":e.pageChange}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.Menu4Idx,expression:"Menu4Idx === '2'"}],staticClass:"right4_2"},[t("el-table",{attrs:{data:e.work_certification.slice(e.begin2,e.end2)}},[t("el-table-column",{attrs:{prop:"datetime",label:"申请时间",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("i",{staticClass:"el-icon-time"}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(i.row.datetime))])]}}])}),t("el-table-column",{attrs:{prop:"send_user",label:"申请用户",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"top",trigger:"hover"}},[t("div",{attrs:{slot:"reference"},slot:"reference"},[t("el-tag",{attrs:{size:"medium"}},[e._v(e._s(i.row.send_user))])],1)])]}}])}),t("el-table-column",{attrs:{prop:"detail",label:"详情",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{staticClass:"detail-button",on:{click:function(t){e.dialogVisible=!0}}},[e._v("点击查看")]),t("el-dialog",{attrs:{title:"认证学者申请",visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 用户名 ")]),e._v(" "+e._s(i.row.name)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 真实姓名 ")]),e._v(" "+e._s(null)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-location-outline"}),e._v(" 描述 ")]),e._v(" "+e._s(null)+" ")],2)],1)],1)]}}])}),t("el-table-column",{attrs:{prop:"operator",label:"处理操作"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{staticClass:"check",on:{click:function(t){return e.accept2(i.$index)}}},[t("i",{staticClass:"el-icon-check"})]),t("el-button",{staticClass:"close",on:{click:function(t){return e.refuse2(i.$index)}}},[t("i",{staticClass:"el-icon-close"})])]}}])})],1),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:Math.ceil(this.work_certification.length/10)},on:{"prev-click":e.prev2,"next-click":e.next2,"current-change":e.pageChange2}})],1)])])])])},a=[],n=(i(560),i(8858),i(1318),i(3228),i(3429),i(3098)),l=i(3822),o=i(8898),r={name:"PersonHomepage",computed:{index(){return l.ZP}},components:{NaviBar:n.Z},mounted(){this.token=localStorage.getItem("token"),null===this.token&&this.$router.push("/login"),(0,o.H9)(this.token).then((e=>{0===e.data.result?(e.data.id===parseInt(this.$route.params.id)?this.isSelf=!0:this.isSelf=!1,this.email=e.data.email,this.username=e.data.username,this.name=e.data.name,this.imageUrl=e.data.photo_url_out,e.data.is_author?(this.isAuthor=!0,this.aid=e.data.author_id,console.log(this.aid),(0,o.nq)(this.aid).then((e=>{console.log(e),console.log(e.data._source),null===e.data._source.last_known_institution?this.institution="暂无机构信息":this.institution=e.data._source.last_known_institution.display_name,null===e.data._source.display_name?this.name=null:this.name=e.data._source.display_name}))):(this.isAuthor=!1,this.name=null,this.institution="暂无机构信息"),this.isManager=e.data.is_admin,this.isManager&&((0,o.zL)(this.token).then((e=>{0===e.data.result?(this.scholar_certification=e.data.messages,console.log(this.scholar_certification)):console.log(e.data.messages)})),(0,o.Cl)(this.token).then((e=>{0===e.data.result?(this.work_certification=e.data.messages,console.log(this.work_certification)):console.log(e.data.messages)})))):this.$notify({title:"错误",message:"获取用户信息失败",type:"error"})})),(0,o.jh)(this.token).then((e=>{0===e.data.result?this.collect_data=e.data.messages:this.$notify({title:"错误",message:"获取收藏成果失败",type:"error"})})),(0,o.GW)(this.token).then((e=>{console.log(e),0===e.data.result?(console.log("1"),console.log(e.data.objects,"33333"),this.visit_data=e.data.objects):this.$notify({title:"错误",message:"获取浏览记录失败",type:"error"})}))},data(){return{aid:"",token:null,is_black:!1,username:"username",name:"name",institution:"institution",email:"",imageUrl:"",MidNavIdx:"1",Menu1Idx:"1",Menu4Idx:"1",keywordsInput:"",isMasterpieceOnly:!1,isAuthor:!1,isManager:!1,isSelf:!1,isInterested:!1,isCancel:!1,begin1:0,end1:10,begin2:0,end2:10,begin3:0,end3:10,begin4:0,end4:10,author:{name:"",institution:"",email:""},scholar_certification:[{id:"",author_id:"",username:"",send_user_id:"",datetime:""}],work_certification:[{id:"",work_id:"",send_user:"",send_user_id:"",author_id:"",datetime:""}],collect_data:[{paper_id:"",paper_name:""}],visit_data:[{id:"",work_name:"",work_id:"",time:""}],infoDialog:!1,infoDialogTitle:!0,dialogVisible:!1,inputDisabled:!0}},methods:{modify(){this.infoDialog=!0},modify_info(){this.infoDialogTitle=!1,this.inputDisabled=!1},modify_confirm(){this.infoDialogTitle=!0,this.inputDisabled=!0},modify_cancel(){this.infoDialogTitle=!0,this.inputDisabled=!0},modify_clear(){this.username="",this.name="",this.institution="",this.email=""},handleAvatarSuccess(e,t){this.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload(e){const t="image/jpeg"===e.type,i=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),i||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&i},handleSelect(e,t){console.log(e,t),this.MidNavIdx=e},handleSelect1(e,t){console.log(e,t),this.Menu1Idx=e},handleSelect4(e,t){console.log(e,t),this.Menu4Idx=e},search(){alert(this.keywordsInput)},interest(){this.isInterested=!0},cancel_display(){this.isCancel=!0},cancel_hide(){this.isCancel=!1},cancel_interest(){this.isInterested=!1},gotoColArt(e){this.$router.push("/paper/"+btoa(encodeURIComponent(JSON.stringify(e))))},accept(e){console.log(e);const t=new FormData;t.append("result","1"),t.append("message_id",this.scholar_certification[e].id),(0,o.Bx)(t,this.token).then((t=>{0===t.data.result?(this.$notify({title:"成功",message:"已同意",type:"success"}),this.scholar_certification.splice(e,1)):this.$notify({title:"警告",message:"操作失败",type:"warning"})}))},refuse(e){console.log(e);const t=new FormData;t.append("result","0"),t.append("message_id",this.scholar_certification[e].id),(0,o.Bx)(t,this.token).then((t=>{0===t.data.result?(this.$notify({title:"成功",message:"已拒绝",type:"success"}),this.scholar_certification.splice(e,1)):this.$notify({title:"警告",message:"操作失败",type:"warning"})}))},accept2(e){console.log(e);const t=new FormData;t.append("result","1"),t.append("message_id",this.work_certification[e].id),(0,o.KZ)(t,this.token).then((t=>{0===t.data.result?(this.$notify({title:"成功",message:"已同意",type:"success"}),this.work_certification.splice(e,1)):this.$notify({title:"警告",message:"操作失败",type:"warning"})}))},refuse2(e){console.log(e);const t=new FormData;t.append("result","0"),t.append("message_id",this.work_certification[e].id),(0,o.KZ)(t,this.token).then((t=>{0===t.data.result?(this.$notify({title:"成功",message:"已拒绝",type:"success"}),this.work_certification.splice(e,1)):this.$notify({title:"警告",message:"操作失败",type:"warning"})}))},prev(){this.begin1>=10?(this.begin1-=10,this.end1-=10):(this.begin1=0,this.end1=10)},next(){this.begin1+=10,this.end1+=10},pageChange(e){console.log(e),this.begin1=10*(e-1),this.end1=10*e},prev2(){this.begin2>=10?(this.begin2-=10,this.end2-=10):(this.begin2=0,this.end2=10)},next2(){this.begin2+=10,this.end2+=10},pageChange2(e){console.log(e),this.begin2=10*(e-1),this.end2=10*e},prev3(){this.begin3>=10?(this.begin3-=10,this.end3-=10):(this.begin3=0,this.end3=10)},next3(){this.begin3+=10,this.end3+=10},pageChange3(e){console.log(e),this.begin3=10*(e-1),this.end3=10*e},prev4(){this.begin4>=10?(this.begin4-=10,this.end4-=10):(this.begin4=0,this.end4=10)},next4(){this.begin4+=10,this.end4+=10},pageChange4(e){console.log(e),this.begin4=10*(e-1),this.end4=10*e},clear_visit(){(0,o.DU)(this.token).then((e=>{0===e.data.result?this.visit_data=this.visit_data.slice(0,0):this.$notify({title:"错误",message:e.data.message,type:"error"})}))},visitAuth(e){this.dialogVisible=!0,(0,o.nq)(this.aid).then((e=>{console.log(e),console.log(e.data._source),null===e.data._source.last_known_institution?this.institution="暂无机构信息":this.institution=e.data._source.last_known_institution.display_name,null===e.data._source.display_name?this.name=null:this.name=e.data._source.display_name}))},uploadPic(e){const t=new FormData;t.append("avatar",e.file),console.log(e.file),(0,o.ab)(t,this.token).then((e=>{0===e.data.result?(this.$notify({title:"成功",message:"上传成功",type:"success"}),this.$router.go(0)):this.$notify({title:"警告",message:"上传失败",type:"warning"})}))}}},c=r,d=i(1001),u=(0,d.Z)(c,s,a,!1,null,"83f4277e",null),p=u.exports}}]);
//# sourceMappingURL=641.4d4d325c.js.map